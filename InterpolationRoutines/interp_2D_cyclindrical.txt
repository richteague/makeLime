double linterpolate(double rad, double alt, int aidx, int bidx,
                    int cidx, int didx, const double arr[NCELLS])
{	

    double A, B, f;
    f = (alt - zvals[aidx]) / (zvals[bidx] - zvals[aidx]);
    A = arr[aidx] * (1. - f) + arr[bidx] * f;
    f = (alt - zvals[cidx]) / (zvals[didx] - zvals[cidx]);
    B = arr[cidx] * (1. - f) + arr[didx] * f;
    f = (rad - rvals[aidx]) / (rvals[cidx] - rvals[aidx]);
    return A * (1. - f) + B * f;

}
